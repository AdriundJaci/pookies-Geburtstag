<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday Priya üíó</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<style>
/* ========================= */
/* GLOBAL RESET */
/* ========================= */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background:#FFDAE9;
    min-height:100vh;
}

/* ========================= */
/* INTRO PAGE */
/* ========================= */

#introPage{
    position:fixed;
    inset:0;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    z-index:20;
    background:#FFDAE9;
}

#introPage h1{
    font-size:2.8rem;
    margin-bottom:20px;
}

.cta-button{
    padding:14px 30px;
    border:none;
    border-radius:30px;
    font-size:1.1rem;
    cursor:pointer;
    background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);
    color:white;
    transition:0.3s;
}

.cta-button:hover{
    transform:scale(1.05);
}

/* ========================= */
/* ENVELOPE + PUZZLE (DEIN ORIGINAL) */
/* ========================= */

#envelopeStage {
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    position:fixed;
    inset:0;
    z-index:10;
}

body.show-modal .container {
    display:flex;
}

.container {
    display:none;
    flex-direction:column;
    text-align:center;
    background:white;
    padding:40px 36px;
    border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
    max-width:650px;
    margin:auto;
}

.modal-view{
    display:none;
}

.modal-view.visible{
    display:block;
}

/* === Envelope === */

.envelope{
    position:relative;
    width:300px;
    height:220px;
    background:#f5e6d3;
    border:1px solid #d4c4a8;
    border-radius:4px;
    cursor:pointer;
    transition:0.3s;
}

.envelope:hover{
    transform:scale(1.05);
}

.envelope-flap{
    position:absolute;
    inset:0;
    background:linear-gradient(165deg,#e8d5c4 0%,#d4c4a8 45%,#c9b89a 100%);
    clip-path:polygon(0 0,50% 50%,100% 0);
    transform-origin:top center;
    transition:0.8s cubic-bezier(0.34,1.2,0.64,1);
}

.envelope.opening .envelope-flap{
    transform:rotateX(-170deg);
}

.envelope-heart{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:50px;
    height:50px;
    color:#c41e3a;
    z-index:1;
}

/* Puzzle minimal (rest identical logic stays same) */
.puzzle-grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:2px;
    margin-top:20px;
}

.puzzle-tile{
    width:100px;
    height:100px;
    background-size:cover;
    cursor:pointer;
}

.puzzle-tile.empty{
    background:none;
    cursor:default;
}

.yes-only-btn{
    margin-top:20px;
    padding:12px 24px;
    border-radius:50px;
    border:none;
    background:#FFDAE9;
    font-weight:600;
    cursor:pointer;
}

.success-yay{
    font-size:22px;
    margin-bottom:20px;
}

.reset-btn{
    background:none;
    border:none;
    text-decoration:underline;
    cursor:pointer;
    margin-top:10px;
}
</style>
</head>

<body>

<!-- ================= INTRO PAGE ================= -->
<div id="introPage">
    <h1>Happy Birthday Priya üíó</h1>
    <button class="cta-button" id="enterBtn">
        Click to Enter Our World üíï
    </button>
</div>

<!-- ================= ENVELOPE ================= -->
<div id="envelopeStage">
    <div class="envelope" id="envelope">
        <div class="envelope-heart">‚ù§Ô∏è</div>
        <div class="envelope-flap"></div>
    </div>
</div>

<!-- ================= MODAL ================= -->
<div class="container">
    <div id="puzzleView" class="modal-view">
        <h2>L√∂se das Puzzle ü§î</h2>
        <div class="puzzle-grid" id="puzzleGrid"></div>
        <button class="yes-only-btn" id="yesBtn" style="display:none;">
            JAAAAAAAAAA
        </button>
    </div>

    <div id="successView" class="modal-view">
        <p class="success-yay">
            Ein Fr√ºhst√ºck zu zweit in Gilching im Schl√∂glhof ‚ù§Ô∏è
        </p>
        <img src="cat.gif.gif" width="250">
        <button class="reset-btn" onclick="location.reload()">Reset</button>
    </div>
</div>

<script>

/* ================= INTRO SWITCH ================= */

document.getElementById("enterBtn").addEventListener("click",()=>{
    gsap.to("#introPage",{opacity:0,duration:1,onComplete:()=>{
        document.getElementById("introPage").style.display="none";
    }});
});

/* ================= ENVELOPE ================= */

const envelope=document.getElementById("envelope");
const envelopeStage=document.getElementById("envelopeStage");
const puzzleView=document.getElementById("puzzleView");
const container=document.querySelector(".container");

envelope.addEventListener("click",()=>{
    envelope.classList.add("opening");
    setTimeout(()=>{
        envelopeStage.style.display="none";
        document.body.classList.add("show-modal");
        puzzleView.classList.add("visible");
    },800);
});

/* ================= PUZZLE ================= */

const puzzleGrid=document.getElementById("puzzleGrid");
const yesBtn=document.getElementById("yesBtn");

let solution=[1,2,3,4,5,6,7,8,9];
let current=[...solution];
const EMPTY=3;

function init(){
    scramble();
    render();
}

function scramble(){
    for(let i=0;i<10;i++){
        const e=current.indexOf(EMPTY);
        const moves=getMoves(e);
        const r=moves[Math.floor(Math.random()*moves.length)];
        [current[e],current[r]]=[current[r],current[e]];
    }
}

function getMoves(e){
    const m=[];
    const r=Math.floor(e/3);
    const c=e%3;
    if(r>0)m.push(e-3);
    if(r<2)m.push(e+3);
    if(c>0)m.push(e-1);
    if(c<2)m.push(e+1);
    return m;
}

function render(){
    puzzleGrid.innerHTML="";
    current.forEach((p,i)=>{
        const t=document.createElement("div");
        t.className="puzzle-tile";
        if(p===EMPTY){
            t.classList.add("empty");
        }else{
            t.style.backgroundImage=`url('images/tile-${p}.png')`;
            t.onclick=()=>move(i);
        }
        puzzleGrid.appendChild(t);
    });
}

function move(i){
    const e=current.indexOf(EMPTY);
    if(getMoves(e).includes(i)){
        [current[e],current[i]]=[current[i],current[e]];
        render();
        if(check()){
            yesBtn.style.display="inline-block";
        }
    }
}

function check(){
    return current.every((v,i)=>v===solution[i]);
}

document.getElementById("yesBtn").addEventListener("click",()=>{
    puzzleView.classList.remove("visible");
    document.getElementById("successView").classList.add("visible");
});

init();

</script>

</body>
</html>
